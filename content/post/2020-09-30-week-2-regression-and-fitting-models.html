

<p>This week we will cover data summaries, data structure, linear regression and its assumptions.</p>
<p>At the beginning of each session we will need to load our libraries, so let’s load the packages for this week</p>
<pre class="r"><code>library(tidyverse)
library(plotrix)
library(ggpubr) #install.packages(&quot;ggpubr&quot;)
library(qqplotr) #install.packages(&quot;qqplotr&quot;)
library(PerformanceAnalytics)#install.packages(&quot;PerformanceAnalytics&quot;)
library(gcookbook)
library(tidyr) #install.packages(&quot;tidyr&quot;)  </code></pre>
<div id="sample-statistics-and-summary-results" class="section level1">
<h1>Sample Statistics and Summary results</h1>
<p>Mean, variance, and error values are always required for the final report. It can take a while to sort the data in the right way and several times you may want to check how your data looks frequently. <code>Tydiverse</code> is a complex group of packages that include <code>ggplot2</code> and <code>dplyr</code>. Adding, changing, combining, removing is simple with <code>dplyr</code>.</p>
<pre class="r"><code>data(&quot;storms&quot;)
head(storms) #look at the first 6 rows</code></pre>
<pre><code>## # A tibble: 6 x 13
##   name   year month   day  hour   lat  long status category  wind pressure
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;ord&gt;    &lt;int&gt;    &lt;int&gt;
## 1 Amy    1975     6    27     0  27.5 -79   tropi~ -1          25     1013
## 2 Amy    1975     6    27     6  28.5 -79   tropi~ -1          25     1013
## 3 Amy    1975     6    27    12  29.5 -79   tropi~ -1          25     1013
## 4 Amy    1975     6    27    18  30.5 -79   tropi~ -1          25     1013
## 5 Amy    1975     6    28     0  31.5 -78.8 tropi~ -1          25     1012
## 6 Amy    1975     6    28     6  32.4 -78.7 tropi~ -1          25     1012
## # ... with 2 more variables: ts_diameter &lt;dbl&gt;, hu_diameter &lt;dbl&gt;</code></pre>
<pre class="r"><code>mean(storms$wind) # mean wind speed of all the recored storms</code></pre>
<pre><code>## [1] 53.495</code></pre>
<pre class="r"><code>sd(storms$pressure) # pressure standard deviation of all the recored storms</code></pre>
<pre><code>## [1] 19.51678</code></pre>
<pre class="r"><code>plotrix::std.error(storms$ts_diameter) # standard error of storm eye diameter </code></pre>
<pre><code>## [1] 2.394685</code></pre>
<p>I am sure that you are familiar with that as it is something we can get from any statistical program, now, let’s look at how to deal with more information and different results.</p>
<pre class="r"><code>#library(tidyverse)
storms[,c(1,2,10,11)]%&gt;% #dataset and variables we will work with [row,column] use c(for selecting multiple columns)
  dplyr::group_by(name,year)%&gt;% #group by name and year
  dplyr::summarise_all(funs(mean(.,na.rm = T), #use funs( to get multiple stimators)
                           sd(.),
                           var(.), #sd^2
                           plotrix::std.error(.),
                           observations=length(.))) # we can name the variables directly  length tells you how many observations in each group</code></pre>
<pre><code>## # A tibble: 426 x 12
## # Groups:   name [198]
##    name   year wind_mean pressure_mean wind_sd pressure_sd wind_var pressure_var
##    &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;
##  1 AL01~  1993      27.5         1000.    2.67       1.55      7.14        2.41 
##  2 AL01~  2000      25           1009.    0          0.957     0           0.917
##  3 AL02~  1992      29           1007.    2.24       0.894     5           0.8  
##  4 AL02~  1994      24.2         1016.    5.85       0.753    34.2         0.567
##  5 AL02~  1999      28.8         1005.    2.5        0.957     6.25        0.917
##  6 AL02~  2000      29.2         1009.    1.95       0.515     3.79        0.265
##  7 AL02~  2001      25           1011     0          0.707     0           0.5  
##  8 AL02~  2003      30           1009.    0          0.957     0           0.917
##  9 AL02~  2006      38           1002.    5.70       4.04     32.5        16.3  
## 10 AL03~  1987      21.2         1010.    8.71       2.44     75.8         5.97 
## # ... with 416 more rows, and 4 more variables:
## #   `wind_plotrix::std.error` &lt;dbl&gt;, `pressure_plotrix::std.error` &lt;dbl&gt;,
## #   wind_observations &lt;int&gt;, pressure_observations &lt;int&gt;</code></pre>
<ul>
<li><strong>group_by</strong> is one of the best elements of dplyr, it works by making one data set for all the information you add in group_by(). Here, we group all the storms with the same name, if there are multiple elements then we group them again by year. In the output you will see there is ’Groups: name [198]` this means that there are 198 names, some with multiple years so we get a data set with 426 rows.</li>
<li><strong>summarise_all</strong> means that all the functions will be applied to all the variables excluded from <code>group_by</code>.</li>
<li><strong>na.rm</strong> and <strong>.</strong>: The <code>.</code> means take all the information as it is no changes. <code>na.rm=T</code> means TRUE (yes) to remove missing values if there are some</li>
</ul>
<p>You want to know if there is a relationship between wind and pressure so we need to visualize both variables in a scatter plot.</p>
<pre class="r"><code>data(&quot;storms&quot;) #we will work with the dataset: Carbon Dioxide Uptake in Grass Plants
tail(storms,4) #show me the last 4 observations </code></pre>
<pre><code>## # A tibble: 4 x 13
##   name   year month   day  hour   lat  long status category  wind pressure
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;ord&gt;    &lt;int&gt;    &lt;int&gt;
## 1 Kate   2015    11    11     0  33.1 -71.3 hurri~ 1           65      990
## 2 Kate   2015    11    11     6  35.2 -67.6 hurri~ 1           70      985
## 3 Kate   2015    11    11    12  36.2 -62.5 hurri~ 1           75      980
## 4 Kate   2015    11    11    18  37.6 -58.2 hurri~ 1           65      980
## # ... with 2 more variables: ts_diameter &lt;dbl&gt;, hu_diameter &lt;dbl&gt;</code></pre>
<pre class="r"><code># we will begin by ploting the variables of our hypothesis
ggplot(storms,mapping = aes(x=wind,y=pressure))+
  geom_point()</code></pre>
<p><img src="2020-09-30-week-2-regression-and-fitting-models_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Looks like there is some sort of relationship, negative relationship, between our variables of interest. However, we need statistical models to determine the changes in pressure with wing and how significant are those changes.</p>
</div>
<div id="least-squares-linear-regression" class="section level1">
<h1>Least squares Linear Regression:</h1>
<p>The least squares method also deffined as the <em>line of best fit</em> aims to produce a model that reduces the <em>variation </em>or <em>error</em> between the expected and predicted values. Next, we will run a simple linear regression with <code>lm</code> with our two variables to understand this concept and the estimation of model parameters which are often called <strong>ordinary least squares estimates</strong>. The previous scatter looked roughly linear, so let’s examine their relationship.</p>
<pre class="r"><code>fit.lm&lt;-lm(pressure~wind, data = storms) # y~x makes sure to use this `~`
fit.lm #information inside fit.lm</code></pre>
<pre><code>## 
## Call:
## lm(formula = pressure ~ wind, data = storms)
## 
## Coefficients:
## (Intercept)         wind  
##   1029.6670      -0.7015</code></pre>
<p>Equation for the LSLR: 1029.66 - 0.7015x</p>
<p>We can also add the error term by using <code>sigma</code></p>
<pre class="r"><code>sigma(fit.lm) # residual standard deviation E</code></pre>
<pre><code>## [1] 6.536737</code></pre>
<pre class="r"><code>confint(fit.lm) # get confidence intervals for all the terms</code></pre>
<pre><code>##                    2.5 %       97.5 %
## (Intercept) 1029.3759591 1029.9580714
## wind          -0.7064102   -0.6966387</code></pre>
Therefore, the equation for the LSLR with a CI of 95% confidence level will be: 1029.66 - 0.7015x 
</div>
