---
title: 'Week 8: Curvature and Nonconstant Variance'
author: Roberto Supe
date: '2020-12-02'
slug: week-8-curvature-and-nonconstant-variance
categories:
  - R
tags:
  - blog
  - factors
  - factors
  - functions
  - lack of fit
  - mean
  - model comparison
  - plot
  - R Markdown
  - regression
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>
<script src="{{< blogdown/postref >}}index_files/htmlwidgets/htmlwidgets.js"></script>
<script src="{{< blogdown/postref >}}index_files/plotly-binding/plotly.js"></script>
<script src="{{< blogdown/postref >}}index_files/typedarray/typedarray.min.js"></script>
<script src="{{< blogdown/postref >}}index_files/jquery/jquery.min.js"></script>
<link href="{{< blogdown/postref >}}index_files/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/crosstalk/js/crosstalk.min.js"></script>
<link href="{{< blogdown/postref >}}index_files/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/plotly-main/plotly-latest.min.js"></script>


<p>This week we will use the following packages as always, load them at the beginning of the sessionðŸ‘¨ðŸ‘©</p>
<pre class="r"><code>library(tidyverse)
library(car)
library(dae) #install.packages(&quot;dae&quot;)
library(car)
library(DMwR)
library(olsrr)
library(plotly)
#install.packages(&quot;package_name&quot;)</code></pre>
<p>Linear regressions can fit any data; this also means that you may get similar regression results even with different data because you fit the best option to reduce the variance between your points. Let`s look at the following plots with similar regression results,<span class="math inline">\(\sigma^2\)</span>, and <span class="math inline">\(R^2\)</span> but with different observations and distributions.</p>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-2-1.png" width="50%" /><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-2-2.png" width="50%" /><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-2-3.png" width="50%" /><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-2-4.png" width="50%" /></p>
<p>Some of these plots may be extreme cases, and it does not require statistical analysis to determine that one point is influencing our regression, but in the case of outliers, it may not be that obvious. Therefore, for general practice as mention in <a href="https://stats-bnu-2020.netlify.app/2020/09/30/week-2-regression-and-fitting-models/">assumptions for linear regression</a> it is required that you look at the residual plots.</p>
<pre class="r"><code>fit.1&lt;-lm(Model~x,plots)
residualPlot(fit.1)
fit.1&lt;-lm(Curvature~x,plots)
residualPlot(fit.1)
fit.1&lt;-lm(Outlier~x,plots)
residualPlot(fit.1)
fit.1&lt;-lm(Curvature~c(rep(8,10),19),plots) #data in different formats
residualPlot(fit.1)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-3-1.png" width="50%" /><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-3-2.png" width="50%" /><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-3-3.png" width="50%" /><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-3-4.png" width="50%" /></p>
<p>The best residuals sit on the <code>0</code> line (y-axis) but in general, the closer to this line, the better. Similarly, they are scattered along with the extent of x. <strong>If the residual plot demonstrates either residuals or variance of residuals is not constant, then we must conclude that the model is incorrect in some respect. Still, we may not be able to tell if the problem is due to a misspecified mean function or a misspecified variance function.</strong>. Now, letâ€™s use our algae data and fit a regression to analyze some indicators.</p>
<pre class="r"><code>fit1&lt;-lm(NO3~mxPH+Cl,data=algae)
#residuals&lt;- fit1$residuals
plot(fit1$residuals)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>In these datasets, we have one clear outlier, so we should treat that observation.
We can also plot residuals against individual predictors <span class="math inline">\(x_k\)</span>.</p>
<pre class="r"><code>plot(x = fit1$model$mxPH,y = fit1$residuals)
abline(0,0)
a&lt;-car::residualPlot(fit1,variable=&quot;Cl&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-5-1.png" width="50%" /><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-5-2.png" width="50%" /></p>
<p>There are a few packages for these tests, and we will have a look at a ggplot2 option.</p>
<pre class="r"><code>x&lt;-olsrr::ols_plot_resid_fit(fit1,print_plot = F)+
  theme_bw()
ggplotly(x)</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"data":[{"x":[3.78432805201669,3.17819243205726,3.20371086078683,4.01457259292815,3.57958345896806,3.49726264078676,3.80610018196929,3.67118786231002,1.90181708777132,2.81250162864166,3.1698009429911,3.57229084415096,3.04626592651809,3.10394036773581,2.75677921156539,3.33528662914814,3.02505758551475,3.28914838307738,3.69305195582022,4.17604693307125,4.60507596413449,3.79918817020485,3.60212332954295,3.37321841618176,3.01319877572633,3.15388843339258,4.16858420139184,4.58839402988719,2.86748103980853,3.96700391797512,3.73817020239482,2.91678686276986,3.2617360589531,2.62469962713426,2.71818513750783,2.13940541672283,2.09793753643142,2.56971041419177,2.49609063068393,2.84077860823099,4.11586648053857,3.41603089507888,3.09725984906827,3.18204773236244,3.34610268919547,3.85447724754387,3.89688739503347,3.46840581662666,4.00626282486684,3.82245611375174,3.0973681489187,2.82159292780788,2.8032969182339,2.88768643905673,3.30165895666579,3.88688369454387,3.47000666281297,3.94304839134915,4.15769024894032,3.97985017523915,3.92612867061757,3.51667273821825,2.54353893887176,3.35312493488135,5.16797372310273,4.87704335012739,1.56284860015556,2.98841553559864,3.10078585987939,3.08768804541927,3.54189200422894,3.69723953220695,3.84030785912861,3.74840286994179,3.7206928062246,3.95119870610764,4.2460885501962,4.21394831265863,3.84671719727814,4.24817601437578,4.33374412621373,5.00845495503068,4.3167181098705,2.38873317104627,4.28330419083706,3.9951366380994,2.9240304489382,2.08062157803212,2.32378102817817,4.78028921897823,4.61038117630833,4.30818520759124,4.53115986415971,4.34313999993168,4.51053677955998,4.17701804425417,2.43039576257748,3.97263557339108,2.92330450076982,2.69407242271819,2.94751641531192,1.57312334082763,2.37771430178056,1.92370533488174,3.94409126165508,3.72391438281953,-0.0963289929298715,1.63965131449797,2.19330599796915,3.44673074185235,4.91848544903926,3.15586773805726,3.25724817739257,3.37580386359173,3.71398017631379,2.29002517162309,1.85353453156468,1.46750060395291,1.56640473774186,2.69051131407631,1.98710694300275,2.28024274144819,3.85438800967324,6.68100721582745,10.7075618955592,5.21424101503007,3.33818374696904,3.11448199977728,2.64153790753205,3.18283621899102,3.71660342747095,3.43073282298386,3.02059301554126,2.90427288158738,4.15837298152868,4.82593288941266,4.16241545643719,3.04246618937875,2.89723166386015,2.75472542209059,2.88051631580845,2.03092677336847,4.09074102221818,4.53213851197908,5.31152838734659,4.91425047178308,4.7744722330915,4.57353391169916,2.63121726513422,2.31198930689893,2.60609180681383,1.11029750276845,2.17726486352064,2.11696773248789,3.95491373565465,3.92952108552312,2.52690914042556,3.01198576878742,2.569950305709,3.24296962734302,4.11891922306164,5.78716147214989,4.35894136342782,3.22542343886658,5.87218959195017,4.72411470062665,1.54561793046138,2.45631682315632,2.02764394110379,1.65115283282076,2.27436435955619,1.8195777099238,2.1529892878341,2.72534928758115,2.54049074639768,2.25298177264816,1.91215208199376,2.39446460732749,2.1424105537231,2.02480409024578,1.77065475515429,2.16795427850781,2.37941292459336,2.12660662464607,2.01796866832441,2.27423076365062,2.36705669291666,5.09426241681442,3.45889198161819],"y":[2.45367194798331,-1.89019243205726,2.12628913921317,-1.71257259292815,6.83641654103194,5.75073735921324,-2.27110018196929,1.31881213768998,-1.01581708777132,-1.42250162864166,-1.6428009429911,-1.98429084415096,-1.82326592651809,-1.63394036773581,-1.30877921156539,-2.01528662914814,-1.60505758551475,-1.84614838307738,-1.97505195582022,-1.35404693307125,0.219924035865513,-3.15718817020485,-0.660123329542953,-1.65821841618176,-1.50319877572633,0.822111566607424,-2.59658420139184,-3.95839402988719,-2.13748103980853,-3.73700391797512,-0.408170202394824,0.863213137230137,-0.241736058953099,0.193300372865741,-2.66818513750783,1.30459458327717,-1.36293753643142,-1.75971041419177,0.917909369316075,1.23022139176901,1.98013351946143,0.412969104921115,5.44574015093173,4.64795226763756,1.20889731080453,1.01552275245613,0.638112604966535,-0.448405816626662,-0.936262824866836,0.68554388624826,-1.4463681489187,-1.64959292780788,-1.8932969182339,-1.55968643905673,-2.09865895666579,-2.41288369454387,-2.70000666281297,-3.02004839134915,-2.94969024894032,-3.05885017523915,-2.87512867061757,-1.79667273821825,1.30646106112824,5.72687506511865,-1.39497372310273,-1.56104335012739,3.60115139984444,-1.70141553559864,-2.36578585987939,-2.42968804541927,-0.231892004228938,-0.462239532206954,1.08969214087139,1.69359713005821,2.4673071937754,0.45680129389236,-0.512088550196197,-0.483948312658629,0.183282802721859,2.91182398562422,-0.555744126213734,-1.69045495503068,0.381281890129504,2.74326682895373,-1.84030419083706,0.944863361900597,-2.5940304489382,-1.77262157803212,-2.05678102817817,-0.802289218978225,1.58961882369167,-1.16818520759124,-1.92815986415971,-1.44413999993168,4.17746322044002,1.27898195574583,-0.11439576257748,4.78636442660892,1.74169549923018,-0.0240724227181852,2.74648358468808,-0.0391233408276304,-0.502714301780562,-0.191705334881743,-3.56309126165508,-3.26291438281953,0.502328992929872,-1.19465131449797,-1.49230599796915,0.453269258147648,-0.73048544903926,4.03913226194274,1.82075182260743,3.26419613640827,-1.55098017631379,-0.369025171623092,0.377465468435315,3.63149939604709,1.38759526225814,1.03548868592369,-0.652106943002754,-1.06824274144819,-2.48038800967324,-0.168007215827453,-4.66256189555919,1.32575898496993,1.52181625303096,2.01551800022272,-1.81553790753205,-2.50983621899102,6.05639657252905,1.66826717701614,-1.35059301554126,-0.600272881587378,4.82562701847132,4.88906711058734,3.57758454356282,-1.62746618937875,-1.31023166386015,-0.652725422090588,-2.34451631580845,0.24207322663153,-1.78074102221818,41.1178614880209,-2.63152838734659,0.495749528216919,0.133527766908496,-0.88853391169916,-2.25521726513422,-0.65698930689893,-0.736091806813826,-1.00829750276845,-2.04726486352064,-1.27096773248789,0.865086264345352,1.48447891447688,-1.66690914042556,-1.28598576878742,1.483049694291,0.435030372656981,-0.557919223061637,-1.86416147214989,-0.450941363427822,-0.713423438866582,-1.41318959195017,-1.37311470062665,-0.604617930461382,-1.44331682315632,-1.03164394110379,-0.98815283282076,-1.60236435955619,-1.0615777099238,-1.2869892878341,-1.90034928758115,-1.84149074639768,3.97201822735184,1.85284791800624,0.410535392672512,0.997589446276898,-0.151804090245783,0.552345244845708,-0.648954278507814,-1.37641292459336,1.49039337535393,0.568031331675591,1.55876923634938,0.832943307083336,-2.11626241681442,-0.658891981618195],"text":["predicted:  3.78432805<br />resid:  2.45367195","predicted:  3.17819243<br />resid: -1.89019243","predicted:  3.20371086<br />resid:  2.12628914","predicted:  4.01457259<br />resid: -1.71257259","predicted:  3.57958346<br />resid:  6.83641654","predicted:  3.49726264<br />resid:  5.75073736","predicted:  3.80610018<br />resid: -2.27110018","predicted:  3.67118786<br />resid:  1.31881214","predicted:  1.90181709<br />resid: -1.01581709","predicted:  2.81250163<br />resid: -1.42250163","predicted:  3.16980094<br />resid: -1.64280094","predicted:  3.57229084<br />resid: -1.98429084","predicted:  3.04626593<br />resid: -1.82326593","predicted:  3.10394037<br />resid: -1.63394037","predicted:  2.75677921<br />resid: -1.30877921","predicted:  3.33528663<br />resid: -2.01528663","predicted:  3.02505759<br />resid: -1.60505759","predicted:  3.28914838<br />resid: -1.84614838","predicted:  3.69305196<br />resid: -1.97505196","predicted:  4.17604693<br />resid: -1.35404693","predicted:  4.60507596<br />resid:  0.21992404","predicted:  3.79918817<br />resid: -3.15718817","predicted:  3.60212333<br />resid: -0.66012333","predicted:  3.37321842<br />resid: -1.65821842","predicted:  3.01319878<br />resid: -1.50319878","predicted:  3.15388843<br />resid:  0.82211157","predicted:  4.16858420<br />resid: -2.59658420","predicted:  4.58839403<br />resid: -3.95839403","predicted:  2.86748104<br />resid: -2.13748104","predicted:  3.96700392<br />resid: -3.73700392","predicted:  3.73817020<br />resid: -0.40817020","predicted:  2.91678686<br />resid:  0.86321314","predicted:  3.26173606<br />resid: -0.24173606","predicted:  2.62469963<br />resid:  0.19330037","predicted:  2.71818514<br />resid: -2.66818514","predicted:  2.13940542<br />resid:  1.30459458","predicted:  2.09793754<br />resid: -1.36293754","predicted:  2.56971041<br />resid: -1.75971041","predicted:  2.49609063<br />resid:  0.91790937","predicted:  2.84077861<br />resid:  1.23022139","predicted:  4.11586648<br />resid:  1.98013352","predicted:  3.41603090<br />resid:  0.41296910","predicted:  3.09725985<br />resid:  5.44574015","predicted:  3.18204773<br />resid:  4.64795227","predicted:  3.34610269<br />resid:  1.20889731","predicted:  3.85447725<br />resid:  1.01552275","predicted:  3.89688740<br />resid:  0.63811260","predicted:  3.46840582<br />resid: -0.44840582","predicted:  4.00626282<br />resid: -0.93626282","predicted:  3.82245611<br />resid:  0.68554389","predicted:  3.09736815<br />resid: -1.44636815","predicted:  2.82159293<br />resid: -1.64959293","predicted:  2.80329692<br />resid: -1.89329692","predicted:  2.88768644<br />resid: -1.55968644","predicted:  3.30165896<br />resid: -2.09865896","predicted:  3.88688369<br />resid: -2.41288369","predicted:  3.47000666<br />resid: -2.70000666","predicted:  3.94304839<br />resid: -3.02004839","predicted:  4.15769025<br />resid: -2.94969025","predicted:  3.97985018<br />resid: -3.05885018","predicted:  3.92612867<br />resid: -2.87512867","predicted:  3.51667274<br />resid: -1.79667274","predicted:  2.54353894<br />resid:  1.30646106","predicted:  3.35312493<br />resid:  5.72687507","predicted:  5.16797372<br />resid: -1.39497372","predicted:  4.87704335<br />resid: -1.56104335","predicted:  1.56284860<br />resid:  3.60115140","predicted:  2.98841554<br />resid: -1.70141554","predicted:  3.10078586<br />resid: -2.36578586","predicted:  3.08768805<br />resid: -2.42968805","predicted:  3.54189200<br />resid: -0.23189200","predicted:  3.69723953<br />resid: -0.46223953","predicted:  3.84030786<br />resid:  1.08969214","predicted:  3.74840287<br />resid:  1.69359713","predicted:  3.72069281<br />resid:  2.46730719","predicted:  3.95119871<br />resid:  0.45680129","predicted:  4.24608855<br />resid: -0.51208855","predicted:  4.21394831<br />resid: -0.48394831","predicted:  3.84671720<br />resid:  0.18328280","predicted:  4.24817601<br />resid:  2.91182399","predicted:  4.33374413<br />resid: -0.55574413","predicted:  5.00845496<br />resid: -1.69045496","predicted:  4.31671811<br />resid:  0.38128189","predicted:  2.38873317<br />resid:  2.74326683","predicted:  4.28330419<br />resid: -1.84030419","predicted:  3.99513664<br />resid:  0.94486336","predicted:  2.92403045<br />resid: -2.59403045","predicted:  2.08062158<br />resid: -1.77262158","predicted:  2.32378103<br />resid: -2.05678103","predicted:  4.78028922<br />resid: -0.80228922","predicted:  4.61038118<br />resid:  1.58961882","predicted:  4.30818521<br />resid: -1.16818521","predicted:  4.53115986<br />resid: -1.92815986","predicted:  4.34314000<br />resid: -1.44414000","predicted:  4.51053678<br />resid:  4.17746322","predicted:  4.17701804<br />resid:  1.27898196","predicted:  2.43039576<br />resid: -0.11439576","predicted:  3.97263557<br />resid:  4.78636443","predicted:  2.92330450<br />resid:  1.74169550","predicted:  2.69407242<br />resid: -0.02407242","predicted:  2.94751642<br />resid:  2.74648358","predicted:  1.57312334<br />resid: -0.03912334","predicted:  2.37771430<br />resid: -0.50271430","predicted:  1.92370533<br />resid: -0.19170533","predicted:  3.94409126<br />resid: -3.56309126","predicted:  3.72391438<br />resid: -3.26291438","predicted: -0.09632899<br />resid:  0.50232899","predicted:  1.63965131<br />resid: -1.19465131","predicted:  2.19330600<br />resid: -1.49230600","predicted:  3.44673074<br />resid:  0.45326926","predicted:  4.91848545<br />resid: -0.73048545","predicted:  3.15586774<br />resid:  4.03913226","predicted:  3.25724818<br />resid:  1.82075182","predicted:  3.37580386<br />resid:  3.26419614","predicted:  3.71398018<br />resid: -1.55098018","predicted:  2.29002517<br />resid: -0.36902517","predicted:  1.85353453<br />resid:  0.37746547","predicted:  1.46750060<br />resid:  3.63149940","predicted:  1.56640474<br />resid:  1.38759526","predicted:  2.69051131<br />resid:  1.03548869","predicted:  1.98710694<br />resid: -0.65210694","predicted:  2.28024274<br />resid: -1.06824274","predicted:  3.85438801<br />resid: -2.48038801","predicted:  6.68100722<br />resid: -0.16800722","predicted: 10.70756190<br />resid: -4.66256190","predicted:  5.21424102<br />resid:  1.32575898","predicted:  3.33818375<br />resid:  1.52181625","predicted:  3.11448200<br />resid:  2.01551800","predicted:  2.64153791<br />resid: -1.81553791","predicted:  3.18283622<br />resid: -2.50983622","predicted:  3.71660343<br />resid:  6.05639657","predicted:  3.43073282<br />resid:  1.66826718","predicted:  3.02059302<br />resid: -1.35059302","predicted:  2.90427288<br />resid: -0.60027288","predicted:  4.15837298<br />resid:  4.82562702","predicted:  4.82593289<br />resid:  4.88906711","predicted:  4.16241546<br />resid:  3.57758454","predicted:  3.04246619<br />resid: -1.62746619","predicted:  2.89723166<br />resid: -1.31023166","predicted:  2.75472542<br />resid: -0.65272542","predicted:  2.88051632<br />resid: -2.34451632","predicted:  2.03092677<br />resid:  0.24207323","predicted:  4.09074102<br />resid: -1.78074102","predicted:  4.53213851<br />resid: 41.11786149","predicted:  5.31152839<br />resid: -2.63152839","predicted:  4.91425047<br />resid:  0.49574953","predicted:  4.77447223<br />resid:  0.13352777","predicted:  4.57353391<br />resid: -0.88853391","predicted:  2.63121727<br />resid: -2.25521727","predicted:  2.31198931<br />resid: -0.65698931","predicted:  2.60609181<br />resid: -0.73609181","predicted:  1.11029750<br />resid: -1.00829750","predicted:  2.17726486<br />resid: -2.04726486","predicted:  2.11696773<br />resid: -1.27096773","predicted:  3.95491374<br />resid:  0.86508626","predicted:  3.92952109<br />resid:  1.48447891","predicted:  2.52690914<br />resid: -1.66690914","predicted:  3.01198577<br />resid: -1.28598577","predicted:  2.56995031<br />resid:  1.48304969","predicted:  3.24296963<br />resid:  0.43503037","predicted:  4.11891922<br />resid: -0.55791922","predicted:  5.78716147<br />resid: -1.86416147","predicted:  4.35894136<br />resid: -0.45094136","predicted:  3.22542344<br />resid: -0.71342344","predicted:  5.87218959<br />resid: -1.41318959","predicted:  4.72411470<br />resid: -1.37311470","predicted:  1.54561793<br />resid: -0.60461793","predicted:  2.45631682<br />resid: -1.44331682","predicted:  2.02764394<br />resid: -1.03164394","predicted:  1.65115283<br />resid: -0.98815283","predicted:  2.27436436<br />resid: -1.60236436","predicted:  1.81957771<br />resid: -1.06157771","predicted:  2.15298929<br />resid: -1.28698929","predicted:  2.72534929<br />resid: -1.90034929","predicted:  2.54049075<br />resid: -1.84149075","predicted:  2.25298177<br />resid:  3.97201823","predicted:  1.91215208<br />resid:  1.85284792","predicted:  2.39446461<br />resid:  0.41053539","predicted:  2.14241055<br />resid:  0.99758945","predicted:  2.02480409<br />resid: -0.15180409","predicted:  1.77065476<br />resid:  0.55234524","predicted:  2.16795428<br />resid: -0.64895428","predicted:  2.37941292<br />resid: -1.37641292","predicted:  2.12660662<br />resid:  1.49039338","predicted:  2.01796867<br />resid:  0.56803133","predicted:  2.27423076<br />resid:  1.55876924","predicted:  2.36705669<br />resid:  0.83294331","predicted:  5.09426242<br />resid: -2.11626242","predicted:  3.45889198<br />resid: -0.65889198"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle-open","line":{"width":1.88976377952756,"color":"rgba(0,0,255,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.636523537354325,11.2477564399836],"y":[0,0],"text":"yintercept: 0","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Residual vs Fitted Values","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.636523537354325,11.2477564399836],"tickmode":"array","ticktext":["0","3","6","9"],"tickvals":[0,3,6,9],"categoryorder":"array","categoryarray":["0","3","6","9"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Fitted Value","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-6.9515830647382,43.4068826571999],"tickmode":"array","ticktext":["0","10","20","30","40"],"tickvals":[0,10,20,30,40],"categoryorder":"array","categoryarray":["0","10","20","30","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Residual","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"a738701d1d02":{"x":{},"y":{},"type":"scatter"},"a73848007155":{"yintercept":{}}},"cur_data":"a738701d1d02","visdat":{"a738701d1d02":["function (y) ","x"],"a73848007155":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p><code>olsrr</code> has many different plots. You can have a look at its <a href="https://cran.r-project.org/web/packages/olsrr/olsrr.pdf">package information</a> to build great ordinary least squares regression models.</p>
<div id="testing-for-nonconstant-variance" class="section level3">
<h3>Testing for Nonconstant Variance</h3>
<p>Breuschâ€“Pagan test determines whether the variance of the errors from a regression model depends on the independent variablesâ€™ values. In that case, heteroskedasticity is present. If the test statistic has a p-value below an appropriate threshold (e.g., p &lt; 0.05), then the null hypothesis of homoskedasticity is rejected, and heteroskedasticity is assumed.</p>
<pre class="r"><code>ncvTest(fit1)
## Non-constant Variance Score Test 
## Variance formula: ~ fitted.values 
## Chisquare = 62.73071, Df = 1, p = 2.3699e-15</code></pre>
<p>Here, we conclude that there is heteroskedasticity (bad), so the variation of our terms depends on the values of the independent variable. There are a few common ways to fix heteroscedasticity:</p>
<ol style="list-style-type: decimal">
<li>Transform the dependent variable; take the log of the dependent variable.</li>
<li>Redefine the dependent variable by adding something like a <em>rate</em>.</li>
<li>Use weighted regression <a href="https://stats-bnu-2020.netlify.app/2020/11/11/week-6-weights-and-lack-of-fit/">week 6</a>.</li>
<li>Lastly, we can perform a different model by removing those outliers (Next Week).</li>
</ol>
</div>
